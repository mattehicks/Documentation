{\rtf1\ansi\deflang1033{\fonttbl{\f6\fcharset0 Arial;}{\f131\fcharset0 Times New Roman;}}{\colortbl;\red102\green102\blue102;\red67\green67\blue67;\red0\green0\blue0;\red17\green85\blue204;}{\stylesheet{\snext0\f6\fs22\cf3\fi0\li0\sl276\slmult1\ri0\ql\widctlpar{\*\stloverrides\f6\fs22\cf3\sl276\slmult1\widctlpar} Normal;}{\s1\sbasedon0\snext0\f6\fs40\cf3\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb400\sa120{\*\stloverrides\fs40\keepn\keep\sb400\sa120\outlinelevel0} heading 1;}{\s2\sbasedon0\snext0\f6\fs32\cf3\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb360\sa120{\*\stloverrides\fs32\keepn\keep\sb360\sa120\outlinelevel1} heading 2;}{\s3\sbasedon0\snext0\f6\fs28\cf2\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb320\sa80{\*\stloverrides\fs28\cf2\keepn\keep\sb320\sa80\outlinelevel2} heading 3;}{\s4\sbasedon0\snext0\f6\fs24\cf1\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb280\sa80{\*\stloverrides\fs24\cf1\keepn\keep\sb280\sa80\outlinelevel3} heading 4;}{\s5\sbasedon0\snext0\f6\fs22\cf1\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb240\sa80{\*\stloverrides\cf1\keepn\keep\sb240\sa80\outlinelevel4} heading 5;}{\s6\sbasedon0\snext0\f6\fs22\i\cf1\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sb240\sa80{\*\stloverrides\i\cf1\keepn\keep\sb240\sa80\outlinelevel5} heading 6;}{\s7\sbasedon0\snext7\f6\fs52\cf3\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sa60{\*\stloverrides\fs52\keepn\keep\sa60} Title;}{\s8\sbasedon0\snext8\f6\fs30\cf1\fi0\li0\sl276\slmult1\ri0\ql\keepn\keep\widctlpar\sa320{\*\stloverrides\fs30\cf1\keepn\keep\sa320} Subtitle;}{\*\cs9\additive Default Paragraph Font;}{\*\cs10\additive\sbasedon9\super Footnote Reference;}{\*\cs11\additive\sbasedon9\super Endnote Reference;}}{\*\listtable{\list{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9679 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-360\li720}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9675 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-360\li1440}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9632 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-180\li2160}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9679 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-360\li2880}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9675 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-360\li3600}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9632 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-180\li4320}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9675 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-360\li5760}{\listlevel\levelstartat1\levelnfc23\leveljc0{\leveltext \'01\u9632 ?;}{\levelnumbers ;}\levelfollow0\ulnone\fi-180\li6480}{\listlevel\levelstartat1\levelnfc0\leveljc0{\leveltext \'00;}{\levelnumbers ;}\levelfollow0}\listid65536}}{\*\listoverridetable{\listoverride\listid65536\listoverridecount0\ls1}}{\*\generator Atlantis Word Processor 2.0.1.0;}{\info{\operator mhicks}{\creatim\yr2015\mo12\dy21\hr12\min1\sec58}{\revtim\yr2017\mo3\dy12\hr15\min9\sec44}}\htmautsp\useltbaln\alntblind\ftnbj\ftnnar\aenddoc\aftnnrlc\paperw12240\paperh15840\margl1440\margr1440\margt1440\margb1440\headery708\footery708\pgndec\pgncont\sftnbj\sftnstart1\sftnrstcont\sftnnar\saftnstart1\saftnrstcont\saftnnrlc\sectfullsaved\fet0\pard\plain\f131\fs24\sl276\slmult1\nowidctlpar\widctlpar\f6\fs22\b\cf3 CM cluster configuration \b0\Cloudera is designed to be configured through the cloudera web interface. Unless you disable the CM, it will overwrite any changes to the XML files that you make. \\Cloudera has a restful API which is documented at http://cdh-master1.staging.hq.YourCompanyDomain.com:7180/static/apidocs/tutorial.html\\http://cdh-master2.prod.hq.YourCompanyDomain.com:7180/cmf/home\\\keepn\keep\sb320\sa80\s3{\*\bkmkstart h.vkoe7cpdo02}\f131\fs24\cf0{\*\bkmkend h.vkoe7cpdo02}\fs28\f6\cf2 FreeIPA + Kerberos - Architecture \\pard\sl276\slmult1\nowidctlpar\widctlpar\fs22\cf3 We are using FreeIPA to control access to the boxes but we cannot set up realms with freeIPA. We are setting up Kerberos per-cluster to manage authentication within the cluster. Kerberos will build trust with FreeIPA.\\keepn\keep\sb320\sa80\s3{\*\bkmkstart h.86n1at3kaud4}\f131\fs24\cf0{\*\bkmkend h.86n1at3kaud4}\fs28\f6\cf2 Step 1: Setting up Kerberos on a cluster\\pard\sl276\slmult1\nowidctlpar\widctlpar\fs22\cf3  See {\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6\ul\cf4 https}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 ://}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 drive}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 .}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 google}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 .}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 com}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 a}}}}\cf4\ul\ulnone\cf3{\ul\cf4{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /}}}}\cf4\ul YourCompanyDomain{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 .}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 com}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 file}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 d}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /0}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 ByXAgtjuh}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 -}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 JzTVNpcllDOFN}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 6}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 SmM}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 /}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 view}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 ?}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 usp}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 =}}}}{{\field{\*\fldinst{\f6  HYPERLINK "https://drive.google.com/a/datarobot.com/file/d/0ByXAgtjuh-JzTVNpcllDOFN6SmM/view?usp=sharing" }}{\fldrslt{\f6 sharing}}}}\cf3\ulnone\\yum install krb5-server\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\fi-360\li720\tx360\tx720\ls1 edit /var/kerberos/krb5kdc/kdc.conf\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 ADD REALM\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab} RD1.HQ.<YOURCOMPANYDOMAIN>.COM = \{\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}  max_life = 1d 0h 0m 0s\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}  max_renewable_life = 7d 0h 0m 0s\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}remove {\b aes256-cts:normal} if we don’t use JCE patch\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 edit {\b /var/kerberos/krb5kdc/kadm5.acl} (access control list) \line */admin@<ENV>.HQ.YourCompanyDomain.COM *\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}edit /etc/krb5.conf\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 add realm and if neeeded add user specific params\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}\pard\fi-360\li2160\sl276\slmult1\nowidctlpar\widctlpar\tx1800\tx2160\ls1\ilvl2 update {\b default_realm}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 add\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}\pard\fi-360\li2160\sl276\slmult1\nowidctlpar\widctlpar\tx1800\tx2160\ls1\ilvl2 [logging]\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}  default = FILE:/var/log/krb5libs.log\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}  kdc = FILE:/var/log/krb5kdc.log\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}  admin_server = FILE:/var/log/kadmind.log\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}See Diff and file at bottom\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 create DB\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 /usr/sbin/kdb5_util create -s\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}see password in personal files\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}WILL FAIL IF IT CANNOT RESOLVE HOSTS\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 Create admin principals\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 /usr/sbin/kadmin.local -q "addprinc root/admin"\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}/usr/sbin/kadmin.local -q "addprinc cmadm/admin"\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}\pard\fi-360\li2160\sl276\slmult1\nowidctlpar\widctlpar\tx1800\tx2160\ls1\ilvl2 for CM to do it\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 start krb5kdc and kadmin\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 systemctl enable krb5kdc\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}systemctl start krb5kdc\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}systemctl enable kadmin\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}systemctl start kadmin\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 TEST IF IT WORKED with admin user (requires PW)\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 kinit root/admin\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 Automate generating keytab\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 Copy /etc/krb5.conf to every host in the cluster\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}from admin server run to generate a keytab (for automation)\line{\b kadmin.local -q "xst -k /etc/krb5kdc.keytab root/admin"}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}test it (OPTIONAL)\line{\b kinit -kt /etc/krb5kdc.keytab root/admin\line klist}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}NOTE Test The {\b /etc/krb5kdc.keytab} can be moved to other machines to give the keypair\line\tab always 600\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 Activate Kerberos in WebApp - See pics “kerberos_admin*” PORT 8080 in ambari\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 click DROPDOWN MENU on top, NOT Side-menu. {\i administration > security}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}select {\i Enable kerberos }and accept checkboxes\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}pg.2 g Dump encryption types with {\b klist -ket /etc/krb5kdc.keytab }and add lines to {\b Kerberose Encryption Types}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}Manage krb5.conf through Cloudera Manager -- {\b NO}\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\b Configured ports - select “yes I am ready to restart”\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 Setting up TLS - fixing config issues\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1\b0 see pic TLS_config_issue\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}Skippable for now\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 restart the manage and cluster \line\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}krb5cc - ticket cache file problems\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 you may have problems if you use keyring instead of a file on file system. comment out {\b default_ccache_name = KEYRING:persistent:%\{uid\} }if this is an issue\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1 Make sure kerberos is working\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ls1\ilvl1 change user to HDFS\line sudo -u hdfs /bin/bash\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}hadoop fs -ls /\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9675?\tab}kinit <name/type> e.g. cmadm/admin\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9632?\tab}\pard\fi-360\li2160\sl276\slmult1\nowidctlpar\widctlpar\tx1800\tx2160\ls1\ilvl2 klist -- see principals\{\listtext\pard\plain\f131\fs24\f6\fs22\cf3\u9679?\tab}\pard\fi-360\li720\sl276\slmult1\nowidctlpar\widctlpar\tx360\tx720\ls1\\pard\sl276\slmult1\nowidctlpar\widctlpar\\keepn\keep\sb320\sa80\s3{\*\bkmkstart h.4vfwpa3ufnh4}\f131\fs24\cf0{\*\bkmkend h.4vfwpa3ufnh4}\fs28\f6\cf2 Step 2: Trust Between Kerberos and FreeIPA\\pard\sl276\slmult1\nowidctlpar\widctlpar\fs22\cf3 go to admin server running free IPA and use MIT kerberos commands to create TGT principal. This works around the fact that freeIPA does not have realms by dropping down to the MIT commands.\\fi-360\li720\tx360\tx720 kadmin.local -q 'addprinc -pw <pw> <princ name>/<MIT/hadoop realm>@<FreeIPA realm>' -x ipa-setup-override-restrictions\line e.g. \line kadmin.local -q 'addprinc -e "aes128-cts:normal" -pw xxxxx krbtgt/RD1.HQ.YourCompanyDomain.COM@YourCompanyDomain.COM' -x ipa-setup-override-restrictions\\\pard\fi-360\li1440\sl276\slmult1\nowidctlpar\widctlpar\tx1080\tx1440\ilvl1 Test it\line kinit cmadm/admin\export KRB5CCNAME=/tmp/ccache_$UID\kdestroy\kinit cmadm/admin\klist\\pard\sl276\slmult1\nowidctlpar\widctlpar\\\[root@bos-rd1-cdh-master1 ~]# cat /etc/krb5.conf\#File modified by ipa-client-install\\includedir /var/lib/sss/pubconf/krb5.include.d/\\[logging]\  default = FILE:/var/log/krb5libs.log\  kdc = FILE:/var/log/krb5kdc.log\  admin_server = FILE:/var/log/kadmind.log\\[libdefaults]\  default_realm = RD1.HQ.YourCompanyDomain.COM\  dns_lookup_realm = false\  dns_lookup_kdc = false\  rdns = false\  ticket_lifetime = 24h\  renew_lifetime = 7d\  forwardable = yes\  udp_preference_limit = 0\  default_ccache_name = FILE:/tmp/krb5_ccache_uid\\\[realms]\  RD1.HQ.YourCompanyDomain.COM = \{\\tab kdc =  bos-rd1-cdh-master1.rd1.hq.YourCompanyDomain.com\\tab admin_server =  bos-rd1-cdh-master1.rd1.hq.YourCompanyDomain.com    \  \}\\  YourCompanyDomain.COM = \{\\tab kdc = bos-admin1.hq.YourCompanyDomain.com:88\\tab master_kdc = bos-admin1.hq.YourCompanyDomain.com:88\\tab admin_server = bos-admin1.hq.YourCompanyDomain.com:749\\tab default_domain = rd1.hq.YourCompanyDomain.com\\tab pkinit_anchors = FILE:/etc/ipa/ca.crt\\  \}\\\[domain_realm]\  .rd1.hq.YourCompanyDomain.com = RD1.HQ.YourCompanyDomain.COM\  rd1.hq.YourCompanyDomain.com = RD1.HQ.YourCompanyDomain.COM\  .YourCompanyDomain.com = YourCompanyDomain.COM\  YourCompanyDomain.com = YourCompanyDomain.COM\\\}